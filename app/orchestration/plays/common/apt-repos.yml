---
- name: "PHP: Check if deb.sury.org repository exists"
  stat:
    path: "{{ sury_repo }}"
  register: sury_repo_check
  changed_when: sury_repo_check.stat.exists == false

- name: "PHP: Add deb.sury.org GPG signature"
  apt_key:
    url: "{{ sury_gpg }}"
    state: present
    validate_certs: no
  when: sury_repo_check.stat.exists == false

- name: "PHP: Add deb.sury.org repository"
  apt_repository:
    repo: "{{ sury_deb }}"
    state: present
  changed_when: sury_repo_check.stat.exists == false
